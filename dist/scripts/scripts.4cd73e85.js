"use strict";angular.module("oyblogApp",["ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch","uuid","ui.router"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){a.state("main",{url:"/",controller:"MainCtrl",templateUrl:"views/main.html"}).state("about",{url:"/about",controller:"AboutCtrl",templateUrl:"views/about.html"}).state("tarinat",{url:"/q/:otsikko/:aihe",controller:"TarinatCtrl",templateUrl:"views/tarinat.html"}),b.otherwise("/"),c.html5Mode(!1).hashPrefix("!")}]).run(["$rootScope",function(a){a.htmlReady=function(b){a.$evalAsync(function(){setTimeout(function(){"function"==typeof window.callPhantom&&window.callPhantom({hello:b})},0)})}}]),angular.module("oyblogApp").controller("MainCtrl",["$scope","$rootScope","$state","$http","$timeout","rfc4122","jsonpService",function(a,b,c,d,e,f,g){a.payable=!0,a.showPayButton=!0;var h=f.v4();if(g.getJSONP("http://79.125.21.225:3090/get_characters?number=50&orient=portrait&callback=JSON_CALLBACK").then(function(b){a.characters=b.data,a.selectedCharacter=b.data[b.data.length-1],a.loadOK=!0,a.widget={title:"Hei "+b.data[b.data.length-1].name+"!"},a.widget2="",a.htmlReady()}),a.selectCharacter=function(b){a.selectedCharacter=b,a.widget={title:"Hei "+b.name+"!"},a.showPayButton=!0},a.startChat=function(){a.showAnswer=!1,this.chatTimer(),a.mAsk=this.widget.title,this.askChat(),angular.element("#myModal").modal("show")},a.stopChat=function(){angular.element("#myModal").modal("hide"),clearInterval(a.timer)},a.askChat=function(){var b="http://79.125.25.179:8000/bot_answer/?uuid="+h+"&phone="+this.selectedCharacter.phone+"&say="+a.mAsk+"&callback=JSON_CALLBACK";d.jsonp(b).success(function(b){a.mAnswer=b.answer})},a.chatContinue=function(){""===this.widget2?a.placeholderstr=this.placeholderstr+"?":(a.widget={title:this.widget2},a.showAnswer=!1,a.mAsk=this.widget2,this.chatTimer(),this.askChat())},a.chatTimer=function(){a.clock=0;var b=Math.floor(16*Math.random())+5;a.timer=setInterval(function(){a.$apply(function(){a.clock+=1,a.clock>b&&(clearInterval(a.timer),a.showAnswer=!0,a.widget2="",a.placeholderstr="???")})},1e3)},angular.element("#FI").length){e(function(){b.$broadcast("closeMenu")},6e4)}}]),angular.module("oyblogApp").controller("AboutCtrl",["$scope","$state",function(a,b){b.go("about",{}),a.htmlReady("about")}]),angular.module("oyblogApp").controller("TarinatCtrl",["$scope","$rootScope","$state","$stateParams","$timeout","freeparagraph",function(a,b,c,d,e,f){if(f.getParagraph(d).then(function(b){a.loadTarina=!0,a.data=b,a.tittelin=d.otsikko,a.aihe=d.aihe,a.htmlReady()},function(){locale.log("Could not obtain data")}),angular.element("#FI").length)var g=e(function(){b.$broadcast("closeMenu"),c.go("main",{})},6e4);a.$on("$destroy",function(){angular.element("#FI").length&&e.cancel(g)})}]),angular.module("oyblogApp").factory("freeparagraph",["$http","$location",function(a,b){return{getParagraph:function(c){var d=c.otsikko+"/"+c.aihe;return console.log(d),a.get("http://"+b.host()+"/paragraph?menupath="+d).then(function(a){return a.data})}}}]),angular.module("oyblogApp").controller("MenuCtrl",["$scope","jsonpService","$rootScope","$location",function(a,b,c,d){a.menuOK=!1,b.getJSON("http://"+d.host()+"/menu?quant=10").then(function(b){a.data=b,a.menuOK=!0}),c.$on("closeMenu",function(){a.menuOK=!1})}]),angular.module("oyblogApp").service("jsonpService",["$http",function(a){this.getJSON=function(b){return a.get(b,{cache:!0}).then(function(a){return a.data})},this.getJSONP=function(b){return a.jsonp(b).success(function(a){return a})}}]),angular.module("oyblogApp").filter("convert_to_url",function(){return function(a){return encodeURI(a)}}),angular.module("oyblogApp").filter("convert_url_to_string",function(){return function(a){return decodeURI(a)}}),angular.module("oyblogApp").filter("thumb_w110shadow6_bff0000",function(){return function(a){return a.replace("thumb","w110shadow6_bff0000")}}),angular.module("oyblogApp").filter("thumb_w300shadow",function(){return function(a){return a.replace("thumb","w300shadow")}});